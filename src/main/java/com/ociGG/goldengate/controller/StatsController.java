package com.ociGG.goldengate.controller;


import com.ociGG.goldengate.Config.CredentialsConfig;
import com.ociGG.goldengate.Config.StatsEntityConfig;
import com.ociGG.goldengate.Services.HttpMethods;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.CrossOrigin;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import java.util.StringTokenizer;



@RestController
@RequestMapping("/stats")
public class StatsController {

    @Autowired
    HttpMethods httpMethods = new HttpMethods();

    String respuesta = "{ \"$schema\": \"api:standardResponse\", \"links\": [ {     \"rel\": \"canonical\", \"href\": \"https://172.19.16.252/services/v2/replicats/ROCAT2/command\",\"mediaType\": \"application/json\"},{ \"rel\": \"self\",\"href\": \"https://172.19.16.252/services/v2/replicats/ROCAT2/command\",\"mediaType\": \"application/json\"}],\"messages\": [],\"response\": { \"$schema\": \"er:commandResult\",\"reply\": \"OKNODOT Start of statistics at 2021-11-16 17:13:57. Integrated Replicat statistics:Total transactions                      4.00  Redirected                    0.00  Replicated procedures                   0.00 DDL operations                0.00 Stored procedures                0.00 Datatype functionality                 0.00 Operation type functionality    0.00 Event actions                           0.00 Direct transactions ratio         0.00% Replicating from CDOCPRBD.OMNICANAL.VARIABLES_AMBIENTE to CDOCPRBD.OMNICANAL.VARIABLES_AMBIENTE: *** Hourly statistics since 2021-11-16 17:00:00 *** No database operations have been performed. Replicating from CDOCPRBD.OMNICANAL.VARIABLES_AMBIENTE to CDOCPRBD.C##GGADMIN.EXCEPTION_ROCATLOG: *** Hourly statistics since 2021-11-16 17:00:00 *** No database operations have been performed. End of statistics.,\"replyData\": {\"$schema\": \"ogg:stats\",\"stats\": [{\"integratedReplicat\": true,\"since\": \"startup\", \"operations\":  [{ \"operation\": \"transactions\", \"count\": 4 },{ \"operation\": \"redirected\",\"count\": 0},{\"operation\": \"replicatedProcedures\",\"count\": 0},{\"operation\": \"ddlOperations\",\"count\": 0},{\"operation\": \"storedProcedures\",\"count\": 0\n},{\"operation\": \"datatypeFunctionality\",\"count\": 0},{\"operation\": \"optypeFunctionality\",\"count\": 0},{\"operation\": \"eventActions\",\"count\": 0},{\"operation\": \"directTransactionRatio\",\"count\": 0.0 } ] },{\"since\": \"2021-11-16T17:00:00.000Z\",\"sourceTable\": \"CDOCPRBD.OMNICANAL.VARIABLES_AMBIENTE\",\"targetTable\": \"CDOCPRBD.OMNICANAL.VARIABLES_AMBIENTE\"},\"since\": \"2021-11-16T17:00:00.000Z\",\"sourceTable\": \"CDOCPRBD.OMNICANAL.VARIABLES_AMBIENTE\",\"targetTable\": \"CDOCPRBD.C##GGADMIN.EXCEPTION_ROCATLOG\"}]}}}";
    String resp2 = "{ \"$schema\": \"api:standardResponse\", \"links\": [ { \"rel\": \"canonical\", \"href\": \"https://172.19.16.252/services/v2/replicats/ROTRNOP2/command\", \"mediaType\": \"application/json\"}, { \"rel\": \"self\", \"href\": \"https://172.19.16.252/services/v2/replicats/ROTRNOP2/command\", \"mediaType\": \"application/json\"} ], \"messages\": [], \"response\": { \"$schema\": \"er:commandResult\", \"reply\": \"OKNODOT nStart of statistics at 2021-11-18 18:15:50. nIntegrated Replicat statistics: tTotal transactions   107652.00 tRedirected  0.00 tReplicated procedures  0.00 DDL operations  0.00 Stored procedures  0.00 Datatype functionality   0.00 Operation type functionality 0.00 Event actions  0.00 Direct transactions ratio 0.00% Replicating from CDOCPRBD.OMNICANAL.BITACORA_PAGO to CDOCPRBD.OMNICANAL.BITACORA_PAGO: *** Hourly statistics since 2021-11-18 18:00:00 ***  Total inserts  141.00    Total updates   61.00  Total deletes  0.00  Total upserts  0.00   Total discards 0.00   Total operations   202.00 Replicating from CDOCPRBD.OMNICANAL.BITACORA_PAGO to CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG: *** Hourly statistics since 2021-11-18 18:00:00 *** No database operations have been performed. Replicating from CDOCPRBD.OMNICANAL.BITACORA_ASIENTO_CTRL to CDOCPRBD.OMNICANAL.BITACORA_ASIENTO_CTRL: *** Hourly statistics since 2021-11-18 18:00:00 ***  Total inserts 432.00  Total updates 490.00  Total deletes  0.00    Total upserts  0.00 Total discards 0.00   Total operations  922.00 Replicating from CDOCPRBD.OMNICANAL.BITACORA_ASIENTO_CTRL to CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG: *** Hourly statistics since 2021-11-18 18:00:00 *** No database operations have been performed. Replicating from CDOCPRBD.OMNICANAL.BITACORA_ASIENTO_DET to CDOCPRBD.OMNICANAL.BITACORA_ASIENTO_ET: *** Hourly statistics since 2021-11-18 18:00:00 *** Total inserts 353.00   Total updates 0.00 Total deletes 0.00  Total upserts   0.00  Total discards 0.00 Total operations  353.00 Replicating from CDOCPRBD.OMNICANAL.BITACORA_ASIENTO_DET to CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG: *** Hourly statistics since 2021-11-18 18:00:00 *** No database operations have been performed. Replicating from CDOCPRBD.OMNICANAL.BITACORA_ASIENTO to CDOCPRBD.OMNICANAL.BITACORA_ASIENTO: *** Hourly statistics since 2021-11-18 18:00:00 ***  Total inserts 473.00 Total updates 0.00 Total deletes 104.00 Total upserts  0.00 Total discards 0.00  Total operations  577.00 Replicating from CDOCPRBD.OMNICANAL.BITACORA_ASIENTO to CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG: *** Hourly statistics since 2021-11-18 18:00:00 *** No database operations have been performed. Replicating from CDOCPRBD.OMNICANAL.CLIENTE to CDOCPRBD.OMNICANAL.CLIENTE: *** Hourly statistics since 2021-11-18 18:00:00 *** Total inserts  17.00  Total updates10.00 Total deletes  0.00Total upserts  0.00  Total discards 0.00  Total operations 27.00 Replicating from CDOCPRBD.OMNICANAL.CLIENTE to CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG: *** Hourly statistics since 2021-11-18 18:00:00 *** No database operations have been performed. Replicating from CDOCPRBD.OMNICANAL.BITACORA_CONFVTA_CTRL to CDOCPRBD.OMNICANAL.BITACORA_CONFVTA_CTRL: *** Hourly statistics since 2021-11-18 18:00:00 ***Total inserts  138.00  Total updates 100.00 Total deletes 0.00 Total upserts  0.00 Total discards  0.00  Total operations  238.00 Replicating from CDOCPRBD.OMNICANAL.BITACORA_CONFVTA_CTRL to CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG: *** Hourly statistics since 2021-11-18 18:00:00 *** No database operations have been performed. Replicating from CDOCPRBD.OMNICANAL.BITACORA_CONFVTA_DET to CDOCPRBD.OMNICANAL.BITACORA_CONFVTA_DET: *** Hourly statistics since 2021-11-18 18:00:00 *** Total inserts 155.00  Total updates 0.00  Total deletes 0.00  Total upserts 0.00 Total discards 0.0 Total operations 155.00 Replicating from CDOCPRBD.OMNICANAL.BITACORA_CONFVTA_DET to CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG: *** Hourly statistics since 2021-11-18 18:00:00 ***No database operations have been performed.Replicating from CDOCPRBD.OMNICANAL.BITACORA_CONFVTA_ASIENTO to CDOCPRBD.OMNICANAL.BITACORA_CONFVTA_ASIENTO: *** Hourly statistics since 2021-11-18 18:00:00 *** Total inserts 198.00 Total updates 0.00 Total deletes 0.00 Total upserts 0.00 Total discards  0.00 Total operations  198.00 Replicating from CDOCPRBD.OMNICANAL.BITACORA_CONFVTA_ASIENTO to CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG: *** Hourly statistics since 2021-11-18 18:00:00 *** No database operations have been performed. Replicating from CDOCPRBD.OMNICANAL.CLIENTE_INVITADO to CDOCPRBD.OMNICANAL.CLIENTE_INVITADO: *** Hourly statistics since 2021-11-18 18:00:00 ***  Total inserts  35.00  Total updates  41.00 Total deletes  0.00 Total upserts 0.00  Total discards 0.00  Total operations  76.00 Replicating from CDOCPRBD.OMNICANAL.CLIENTE_INVITADO to CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG: *** Hourly statistics since 2021-11-18 18:00:00 *** No database operations have been performed. Replicating from CDOCPRBD.OMNICANAL.CLIENTE_DISPOSITIVO to CDOCPRBD.OMNICANAL.CLIENTE_DISPOSITIVO: *** Hourly statistics since 2021-11-18 18:00:00 Total inserts  25.00 Total updates 24.00 Total deletes 0.00 Total upserts  0.00 Total discards   0.00 Total operations  49.00 Replicating from CDOCPRBD.OMNICANAL.CLIENTE_DISPOSITIVO to CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG: *** Hourly statistics since 2021-11-18 18:00:00 *** No database operations have been performed. Replicating from CDOCPRBD.OMNICANAL.DISPOSITIVO to CDOCPRBD.OMNICANAL.DISPOSITIVO: *** Hourly statistics since 2021-11-18 18:00:00 *** Total inserts  7.00 Total updates 20.00 Total deletes  0.00 Total upserts  0.00  Total discards  0.00   Total operations 27.00 Replicating from CDOCPRBD.OMNICANAL.DISPOSITIVO to CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG: *** Hourly statistics since 2021-11-18 18:00:00 *** No database operations have been performed. Replicating from CDOCPRBD.OMNICANAL.SUSCRIPTOR_NOTICIAS to CDOCPRBD.OMNICANAL.SUSCRIPTOR_NOTICIAS: *** Hourly statistics since 2021-11-18 18:00:00 ***  Total inserts  12.00  Total updates  0.00   Total deletes  0.00 Total upserts  0.00 Total discards 0.00  Total operations  12.00 Replicating from CDOCPRBD.OMNICANAL.SUSCRIPTOR_NOTICIAS to CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG: *** Hourly statistics since 2021-11-18 18:00:00 *** No database operations have been performed. Replicating from CDOCPRBD.OMNICANAL.BITACORA_CONSULTA_PAGO to CDOCPRBD.OMNICANAL.BITACORA_CONSULTA_PAGO: *** Hourly statistics since 2021-11-18 18:00:00 *** Total inserts 242.00  Total updates  242.00 Total deletes  0.00 Total upserts 0.00  Total discards 0.00 Total operations  484.00 Replicating from CDOCPRBD.OMNICANAL.BITACORA_CONSULTA_PAGO to CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG: *** Hourly statistics since 2021-11-18 18:00:00 *** No database operations have been performed. Replicating from CDOCPRBD.OMNICANAL.VIAJE_FAVORITO to CDOCPRBD.OMNICANAL.VIAJE_FAVORITO: *** Hourly statistics since 2021-11-18 18:00:00 ***  Total inserts  2.00 Total updates 0.00 Total deletes 0.00  Total upserts  0.00  Total discards  0.00  Total operations 2.00 Replicating from CDOCPRBD.OMNICANAL.VIAJE_FAVORITO to CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG: *** Hourly statistics since 2021-11-18 18:00:00 *** No database operations have been performed. Replicating from CDOCPRBD.OMNICANAL.BITACORA_CUPON to CDOCPRBD.OMNICANAL.BITACORA_CUPON: *** Hourly statistics since 2021-11-18 18:00:00 *** Total inserts  6.00  Total updates  0.00 Total deletes 0.00 Total upserts 0.00 Total discards 0.00 Total operations 6.00 Replicating from CDOCPRBD.OMNICANAL.BITACORA_CUPON to CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG: *** Hourly statistics since 2021-11-18 18:00:00 *** No database operations have been performed. Replicating from CDOCPRBD.OMNICANAL.CLIENTE_PASAJERO to CDOCPRBD.OMNICANAL.CLIENTE_PASAJERO: *** Hourly statistics since 2021-11-18 18:00:00 *** Total inserts  2.00 Total updates 0.00 Total deletes 0.00 Total upserts 0.00 Total discards 0.00 Total operations 2.00 Replicating from CDOCPRBD.OMNICANAL.CLIENTE_PASAJERO to CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG: *** Hourly statistics since 2021-11-18 18:00:00 *** No database operations have been performed. Relicating from CDOCPRBD.OMNICANAL.SUSCRIPNOTICIAS_CONCEPTO to CDOCPRBD.OMNICANAL.SUSCRIPNOTICIAS_CONCEPTO: *** Hourly sta0tistics since 2021-11-18 18:00:00 *** No database operations have been performed. Replicating from CDOCPRBD.OMNICANAL.SUSCRIPNOTICIAS_CONCEPTO to CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG: *** Hourly statistics since 2021-11-18 18:00:00 *** No database operations have been performed. End of statistics.\",\"replyData\": { \"$schema\": \"ogg:stats\", \"stats\": [ { \"integratedReplicat\": true, \"since\": \"startup\", \"operations\": [ { \"operation\": \"transactions\", \"count\":1 07652 },{ \"operation\": \"redirected\", \"count\": 0 },{\"operation\": \"replicatedProcedures\", \"count\": 0 }, {  \"operation\": \"ddlOperations\", \"count\": 0 }, { \"operation\": \"storedProcedures\", \"count\": 0 },{ \"operation\": \"datatypeFunctionality\", \"count\": 0 }, { \"operation\": \"optypeFunctionality\", \"count\": 0 }, { \"operation\": \"eventActions\", \"count\": 0 }, { \"operation\": \"directTransactionRatio\", \"count\": 0.0 } ] },{ \"since\": \"2021-11-18T18:00:00.000Z\", \"sourceTable\": \"CDOCPRBD.OMNICANAL.BITACORA_PAGO\", \"targetTable\": \"CDOCPRBD.OMNICANAL.BITACORA_PAGO\", \"operations\": [ { \"operation\": \"insert\", \"count\": 141 }, { \"operation\":  \"update\", \"count\": 61 }, {\"operation\": \"before\", \"count\": 0 }, { \"operation\": \"alterBefore\", \"count\": 0 },{ \"operation\": \"delete\", \"count\": 0 },{ \"operation\": \"upsert\", \"count\": 0 }, { \"operation\": \"unsupported\", \"count\": 0 },{ \"operation\": \"drop\", \"count\": 0 },{ \"operation\": \"truncate\", \"count\": 0 }, { \"operation\": \"discard\", \"count\": 0 },{ \"operation\": \"ignore\", \"count\": 0 }, { \"operation\":  \"operations\", \"count\": 202 },{ \"operation\":  \"insertCollision\",  \"count\": 0 },{  \"operation\": \"updateCollision\", \"count\": 0 },{ \"operation\": \"deleteCollision\", \"count\": 0 } ] },{ \"since\":\"2021-11-18T18:00:00.000Z\", \"sourceTable\": \"CDOCPRBD.OMNICANAL.BITACORA_PAGO\", \"targetTable\": \"CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG\" }, { \"since\": \"2021-11-18T18:00:00.000Z\", \"sourceTable\": \"CDOCPRBD.OMNICANAL.BITACORA_ASIENTO_CTRL\", \"targetTable\": \"CDOCPRBD.OMNICANAL.BITACORA_ASIENTO_CTRL\", \"operations\": [ { \"operation\": \"insert\", \"count\": 432 }, { \"operation\": \"update\", \"count\": 490 }, { \"operation\": \"before\", \"count\": 0 }, { \"operation\": \"alterBefore\", \"count\": 0 },{ \"operation\": \"delete\", \"count\": 0 },{ \"operation\": \"upsert\", \"count\": 0 }, { \"operation\": \"unsupported\", \"count\": 0 },{\"operation\": \"drop\", \"count\":0 }, { \"operation\": \"truncate\", \"count\": 0 }, { \"operation\": \"discard\", \"count\": 0 },{ \"operation\": \"ignore\", \"count\": 0 }, { \"operation\": \"operations\", \"count\": 922 },{ \"operation\": \"insertCollision\", \"count\": 0 },{ \"operation\": \"updateCollision\", \"count\": 0 },{ \"operation\": \"deleteCollision\", \"count\": 0 } ] }, { \"since\": \"2021-11-18T18:00:00.000Z\", \"sourceTable\": \"CDOCPRBD.OMNICANAL.BITACORA_ASIENTO_CTRL\", \"targetTable\": \"CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG\" }, { \"since\": \"2021-11-18T18:00:00.000Z\", \"sourceTable\": \"CDOCPRBD.OMNICANAL.BITACORA_ASIENTO_DET\", \"targetTable\": \"CDOCPRBD.OMNICANAL.BITACORA_ASIENTO_DET\", \"operations\": [ { \"operation\": \"insert\", \"count\": 353 }, { \"operation\": \"update\", \"count\": 0 },{ \"operation\": \"before\", \"count\": 0 },{ \"operation\": \"alterBefore\", \"count\": 0 }, { \"operation\": \"delete\", \"count\": 0 },{ \"operation\": \"upsert\", \"count\": 0 },{ \"operation\": \"unsupported\", \"count\": 0 }, { \"operation\": \"drop\", \"count\": 0 }, { \"operation\": \"truncate\", \"count\": 0 },{ \"operation\": \"discard\", \"count\": 0 },{ \"operation\": \"ignore\", \"count\": 0 },{ \"operation\": \"operations\", \"count\": 353 },{ \"operation\": \"insertCollision\", \"count\": 0 },{ \"operation\": \"updateCollision\", \"count\": 0 },{ \"operation\": \"deleteCollision\", \"count\": 0 } ] },{ \"since\": \"2021-11-18T18:00:00.000Z\", \"sourceTable\": \"CDOCPRBD.OMNICANAL.BITACORA_ASIENTO_DET\", \"targetTable\": \"CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG\" }, { \"since\": \"2021 -11-18T18:00:00.000Z\", \"sourceTable\": \"CDOCPRBD.OMNICANAL.BITACORA_ASIENTO\", \"targetTable\": \"CDOCPRBD.OMNICANAL.BITACORA_ASIENTO\", \"operations\": [ { \"operation\": \"insert\", \"count\": 473 }, { \"operation\": \"update\", \"count\": 0 },{ \"operation\": \"before\", \"count\": 0 },{\"operation\": \"alterBefore\", \"count\": 0 }, { \"operation\": \"delete\", \"count\": 104 }, { \"operation\": \"upsert\", \"count\": 0 }, { \"operation\": \"unsupported\", \"count\": 0 }, { \"operation\": \"drop\", \"count\": 0 },{ \"operation\": \"truncate\", \"count\": 0 },{ \"operation\": \"discard\", \"count\": 0 },{ \"operation\": \"ignore\", \"count\": 0 }, { \"operation\": \"operations\", \"count\": 577 }, { \"operation\": \"insertCollision\", \"count\": 0 },{ \"operation\": \"updateCollision\", \"count\": 0 },{ \"operation\": \"deleteCollision\", \"count\": 0 } ] }, {\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.BITACORA_ASIENTO\",\"targetTable\":\"CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG\"},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.CLIENTE\",\"targetTable\":\"CDOCPRBD.OMNICANAL.CLIENTE\",\"operations\":[{\"operation\":\"insert\",\"count\":17},{\"operation\":\"update\",\"count\":10},{\"operation\":\"before\",\"count\":0},{\"operation\":\"alterBefore\",\"count\":0},{\"operation\":\"delete\",\"count\":0},{\"operation\":\"upsert\",\"count\":0},{\"operation\":\"unsupported\",\"count\":0},{\"operation\":\"drop\",\"count\":0},{\"operation\":\"truncate\",\"count\":0},{\"operation\":\"discard\",\"count\":0},{\"operation\":\"ignore\",\"count\":0},{\"operation\":\"operations\",\"count\":27},{\"operation\":\"insertCollision\",\"count\":0},{\"operation\":\"updateCollision\",\"count\":0},{\"operation\":\"deleteCollision\",\"count\":0}]},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.CLIENTE\",\"targetTable\":\"CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG\"},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.BITACORA_CONFVTA_CTRL\",\"targetTable\":\"CDOCPRBD.OMNICANAL.BITACORA_CONFVTA_CTRL\",\"operations\":[{\"operation\":\"insert\",\"count\":138},{\"operation\":\"update\",\"count\":100},{\"operation\":\"before\",\"count\":0},{\"operation\":\"alterBefore\",\"count\":0},{\"operation\":\"delete\",\"count\":0},{\"operation\":\"upsert\",\"count\":0},{\"operation\":\"unsupported\",\"count\":0},{\"operation\":\"drop\",\"count\":0},{\"operation\":\"truncate\",\"count\":0},{\"operation\":\"discard\",\"count\":0},{\"operation\":\"ignore\",\"count\":0},{\"operation\":\"operations\",\"count\":238},{\"operation\":\"insertCollision\",\"count\":0},{\"operation\":\"updateCollision\",\"count\":0},{\"operation\":\"deleteCollision\",\"count\":0}]},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.BITACORA_CONFVTA_CTRL\",\"targetTable\":\"CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG\"},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.BITACORA_CONFVTA_DET\",\"targetTable\":\"CDOCPRBD.OMNICANAL.BITACORA_CONFVTA_DET\",\"operations\":[{\"operation\":\"insert\",\"count\":155},{\"operation\":\"update\",\"count\":0},{\"operation\":\"before\",\"count\":0},{\"operation\":\"alterBefore\",\"count\":0},{\"operation\":\"delete\",\"count\":0},{\"operation\":\"upsert\",\"count\":0},{\"operation\":\"unsupported\",\"count\":0},{\"operation\":\"drop\",\"count\":0},{\"operation\":\"truncate\",\"count\":0},{\"operation\":\"discard\",\"count\":0},{\"operation\":\"ignore\",\"count\":0},{\"operation\":\"operations\",\"count\":155},{\"operation\":\"insertCollision\",\"count\":0},{\"operation\":\"updateCollision\",\"count\":0},{\"operation\":\"deleteCollision\",\"count\":0}]},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.BITACORA_CONFVTA_DET\",\"targetTable\":\"CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG\"},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.BITACORA_CONFVTA_ASIENTO\",\"targetTable\":\"CDOCPRBD.OMNICANAL.BITACORA_CONFVTA_ASIENTO\",\"operations\":[{\"operation\":\"insert\",\"count\":198},{\"operation\":\"update\",\"count\":0},{\"operation\":\"before\",\"count\":0},{\"operation\":\"alterBefore\",\"count\":0},{\"operation\":\"delete\",\"count\":0},{\"operation\":\"upsert\",\"count\":0},{\"operation\":\"unsupported\",\"count\":0},{\"operation\":\"drop\",\"count\":0},{\"operation\":\"truncate\",\"count\":0},{\"operation\":\"discard\",\"count\":0},{\"operation\":\"ignore\",\"count\":0},{\"operation\":\"operations\",\"count\":198},{\"operation\":\"insertCollision\",\"count\":0},{\"operation\":\"updateCollision\",\"count\":0},{\"operation\":\"deleteCollision\",\"count\":0}]},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.BITACORA_CONFVTA_ASIENTO\",\"targetTable\":\"CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG\"},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.CLIENTE_INVITADO\",\"targetTable\":\"CDOCPRBD.OMNICANAL.CLIENTE_INVITADO\",\"operations\":[{\"operation\":\"insert\",\"count\":35},{\"operation\":\"update\",\"count\":41},{\"operation\":\"before\",\"count\":0},{\"operation\":\"alterBefore\",\"count\":0},{\"operation\":\"delete\",\"count\":0},{\"operation\":\"upsert\",\"count\":0},{\"operation\":\"unsupported\",\"count\":0},{\"operation\":\"drop\",\"count\":0},{\"operation\":\"truncate\",\"count\":0},{\"operation\":\"discard\",\"count\":0},{\"operation\":\"ignore\",\"count\":0},{\"operation\":\"operations\",\"count\":76},{\"operation\":\"insertCollision\",\"count\":0},{\"operation\":\"updateCollision\",\"count\":0},{\"operation\":\"deleteCollision\",\"count\":0}]},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.CLIENTE_INVITADO\",\"targetTable\":\"CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG\"},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.CLIENTE_DISPOSITIVO\",\"targetTable\":\"CDOCPRBD.OMNICANAL.CLIENTE_DISPOSITIVO\",\"operations\":[{\"operation\":\"insert\",\"count\":25},{\"operation\":\"update\",\"count\":24},{\"operation\":\"before\",\"count\":0},{\"operation\":\"alterBefore\",\"count\":0},{\"operation\":\"delete\",\"count\":0},{\"operation\":\"upsert\",\"count\":0},{\"operation\":\"unsupported\",\"count\":0},{\"operation\":\"drop\",\"count\":0},{\"operation\":\"truncate\",\"count\":0},{\"operation\":\"discard\",\"count\":0},{\"operation\":\"ignore\",\"count\":0},{\"operation\":\"operations\",\"count\":49},{\"operation\":\"insertCollision\",\"count\":0},{\"operation\":\"updateCollision\",\"count\":0},{\"operation\":\"deleteCollision\",\"count\":0}]},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.CLIENTE_DISPOSITIVO\",\"targetTable\":\"CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG\"},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.DISPOSITIVO\",\"targetTable\":\"CDOCPRBD.OMNICANAL.DISPOSITIVO\",\"operations\":[{\"operation\":\"insert\",\"count\":7},{\"operation\":\"update\",\"count\":20},{\"operation\":\"before\",\"count\":0},{\"operation\":\"alterBefore\",\"count\":0},{\"operation\":\"delete\",\"count\":0},{\"operation\":\"upsert\",\"count\":0},{\"operation\":\"unsupported\",\"count\":0},{\"operation\":\"drop\",\"count\":0},{\"operation\":\"truncate\",\"count\":0},{\"operation\":\"discard\",\"count\":0},{\"operation\":\"ignore\",\"count\":0},{\"operation\":\"operations\",\"count\":27},{\"operation\":\"insertCollision\",\"count\":0},{\"operation\":\"updateCollision\",\"count\":0},{\"operation\":\"deleteCollision\",\"count\":0}]},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.DISPOSITIVO\",\"targetTable\":\"CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG\"},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.SUSCRIPTOR_NOTICIAS\",\"targetTable\":\"CDOCPRBD.OMNICANAL.SUSCRIPTOR_NOTICIAS\",\"operations\":[{\"operation\":\"insert\",\"count\":12},{\"operation\":\"update\",\"count\":0},{\"operation\":\"before\",\"count\":0},{\"operation\":\"alterBefore\",\"count\":0},{\"operation\":\"delete\",\"count\":0},{\"operation\":\"upsert\",\"count\":0},{\"operation\":\"unsupported\",\"count\":0},{\"operation\":\"drop\",\"count\":0},{\"operation\":\"truncate\",\"count\":0},{\"operation\":\"discard\",\"count\":0},{\"operation\":\"ignore\",\"count\":0},{\"operation\":\"operations\",\"count\":12},{\"operation\":\"insertCollision\",\"count\":0},{\"operation\":\"updateCollision\",\"count\":0},{\"operation\":\"deleteCollision\",\"count\":0}]},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.SUSCRIPTOR_NOTICIAS\",\"targetTable\":\"CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG\"},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.BITACORA_CONSULTA_PAGO\",\"targetTable\":\"CDOCPRBD.OMNICANAL.BITACORA_CONSULTA_PAGO\",\"operations\":[{\"operation\":\"insert\",\"count\":242},{\"operation\":\"update\",\"count\":242},{\"operation\":\"before\",\"count\":0},{\"operation\":\"alterBefore\",\"count\":0},{\"operation\":\"delete\",\"count\":0},{\"operation\":\"upsert\",\"count\":0},{\"operation\":\"unsupported\",\"count\":0},{\"operation\":\"drop\",\"count\":0},{\"operation\":\"truncate\",\"count\":0},{\"operation\":\"discard\",\"count\":0},{\"operation\":\"ignore\",\"count\":0},{\"operation\":\"operations\",\"count\":484},{\"operation\":\"insertCollision\",\"count\":0},{\"operation\":\"updateCollision\",\"count\":0},{\"operation\":\"deleteCollision\",\"count\":0}]},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.BITACORA_CONSULTA_PAGO\",\"targetTable\":\"CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG\"},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.VIAJE_FAVORITO\",\"targetTable\":\"CDOCPRBD.OMNICANAL.VIAJE_FAVORITO\",\"operations\":[{\"operation\":\"insert\",\"count\":2},{\"operation\":\"update\",\"count\":0},{\"operation\":\"before\",\"count\":0},{\"operation\":\"alterBefore\",\"count\":0},{\"operation\":\"delete\",\"count\":0},{\"operation\":\"upsert\",\"count\":0},{\"operation\":\"unsupported\",\"count\":0},{\"operation\":\"drop\",\"count\":0},{\"operation\":\"truncate\",\"count\":0},{\"operation\":\"discard\",\"count\":0},{\"operation\":\"ignore\",\"count\":0},{\"operation\":\"operations\",\"count\":2},{\"operation\":\"insertCollision\",\"count\":0},{\"operation\":\"updateCollision\",\"count\":0},{\"operation\":\"deleteCollision\",\"count\":0}]},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.VIAJE_FAVORITO\",\"targetTable\":\"CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG\"},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.BITACORA_CUPON\",\"targetTable\":\"CDOCPRBD.OMNICANAL.BITACORA_CUPON\",\"operations\":[{\"operation\":\"insert\",\"count\":6},{\"operation\":\"update\",\"count\":0},{\"operation\":\"before\",\"count\":0},{\"operation\":\"alterBefore\",\"count\":0},{\"operation\":\"delete\",\"count\":0},{\"operation\":\"upsert\",\"count\":0},{\"operation\":\"unsupported\",\"count\":0},{\"operation\":\"drop\",\"count\":0},{\"operation\":\"truncate\",\"count\":0},{\"operation\":\"discard\",\"count\":0},{\"operation\":\"ignore\",\"count\":0},{\"operation\":\"operations\",\"count\":6},{\"operation\":\"insertCollision\",\"count\":0},{\"operation\":\"updateCollision\",\"count\":0},{\"operation\":\"deleteCollision\",\"count\":0}]},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.BITACORA_CUPON\",\"targetTable\":\"CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG\"},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.CLIENTE_PASAJERO\",\"targetTable\":\"CDOCPRBD.OMNICANAL.CLIENTE_PASAJERO\",\"operations\":[{\"operation\":\"insert\",\"count\":2},{\"operation\":\"update\",\"count\":0},{\"operation\":\"before\",\"count\":0},{\"operation\":\"alterBefore\",\"count\":0},{\"operation\":\"delete\",\"count\":0},{\"operation\":\"upsert\",\"count\":0},{\"operation\":\"unsupported\",\"count\":0},{\"operation\":\"drop\",\"count\":0},{\"operation\":\"truncate\",\"count\":0},{\"operation\":\"discard\",\"count\":0},{\"operation\":\"ignore\",\"count\":0},{\"operation\":\"operations\",\"count\":2},{\"operation\":\"insertCollision\",\"count\":0},{\"operation\":\"updateCollision\",\"count\":0},{\"operation\":\"deleteCollision\",\"count\":0}]},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.CLIENTE_PASAJERO\",\"targetTable\":\"CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG\"},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.SUSCRIPNOTICIAS_CONCEPTO\",\"targetTable\":\"CDOCPRBD.OMNICANAL.SUSCRIPNOTICIAS_CONCEPTO\"},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.SUSCRIPNOTICIAS_CONCEPTO\", \"targetTable\": \"CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG\"}]}}}";
    String resp ="{ \"$schema\": \"api:standardResponse\", \"links\": [ { \"rel\": \"canonical\", \"href\": \"https://172.19.16.252/services/v2/replicats/ROTRNOP2/command\", \"mediaType\": \"application/json\"}, { \"rel\": \"self\", \"href\": \"https://172.19.16.252/services/v2/replicats/ROTRNOP2/command\", \"mediaType\": \"application/json\"} ], \"messages\": [], \"response\": { \"$schema\": \"er:commandResult\", \"reply\": \"OKs.\",\"replyData\": { \"$schema\": \"ogg:stats\", \"stats\": [ { \"integratedReplicat\": true, \"since\": \"startup\", \"operations\": [ { \"operation\": \"transactions\", \"count\":1 07652 },{ \"operation\": \"redirected\", \"count\": 0 },{\"operation\": \"replicatedProcedures\", \"count\": 0 }, {  \"operation\": \"ddlOperations\", \"count\": 0 }, { \"operation\": \"storedProcedures\", \"count\": 0 },{ \"operation\": \"datatypeFunctionality\", \"count\": 0 }, { \"operation\": \"optypeFunctionality\", \"count\": 0 }, { \"operation\": \"eventActions\", \"count\": 0 }, { \"operation\": \"directTransactionRatio\", \"count\": 0.0 } ] },{ \"since\": \"2021-11-18T18:00:00.000Z\", \"sourceTable\": \"CDOCPRBD.OMNICANAL.BITACORA_PAGO\", \"targetTable\": \"CDOCPRBD.OMNICANAL.BITACORA_PAGO\", \"operations\": [ { \"operation\": \"insert\", \"count\": 141 }, { \"operation\":  \"update\", \"count\": 61 }, {\"operation\": \"before\", \"count\": 0 }, { \"operation\": \"alterBefore\", \"count\": 0 },{ \"operation\": \"delete\", \"count\": 0 },{ \"operation\": \"upsert\", \"count\": 0 }, { \"operation\": \"unsupported\", \"count\": 0 },{ \"operation\": \"drop\", \"count\": 0 },{ \"operation\": \"truncate\", \"count\": 0 }, { \"operation\": \"discard\", \"count\": 0 },{ \"operation\": \"ignore\", \"count\": 0 }, { \"operation\":  \"operations\", \"count\": 202 },{ \"operation\":  \"insertCollision\",  \"count\": 0 },{  \"operation\": \"updateCollision\", \"count\": 0 },{ \"operation\": \"deleteCollision\", \"count\": 0 } ] },{ \"since\": \"2021-11-18T18:00:00.000Z\", \"sourceTable\": \"CDOCPRBD.OMNICANAL.BITACORA_PAGO\", \"targetTable\": \"CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG\" }, { \"since\": \"2021-11-18T18:00:00.000Z\", \"sourceTable\": \"CDOCPRBD.OMNICANAL.BITACORA_ASIENTO_CTRL\", \"targetTable\": \"CDOCPRBD.OMNICANAL.BITACORA_ASIENTO_CTRL\",  \"operations\": [ { \"operation\": \"insert\", \"count\": 432 }, { \"operation\": \"update\", \"count\": 490 }, { \"operation\": \"before\", \"count\": 0 }, { \"operation\": \"alterBefore\", \"count\": 0 },{ \"operation\": \"delete\", \"count\": 0 },{ \"operation\": \"upsert\", \"count\": 0 }, { \"operation\": \"unsupported\", \"count\": 0 },{\"operation\": \"drop\", \"count\":0 }, { \"operation\": \"truncate\", \"count\": 0 }, { \"operation\": \"discard\", \"count\": 0 },{ \"operation\": \"ignore\", \"count\": 0 }, { \"operation\": \"operations\", \"count\": 922 },{ \"operation\": \"insertCollision\", \"count\": 0 },{ \"operation\": \"updateCollision\", \"count\": 0 },{ \"operation\": \"deleteCollision\", \"count\": 0 } ] }, { \"since\": \"2021-11-18T18:00:00.000Z\", \"sourceTable\": \"CDOCPRBD.OMNICANAL.BITACORA_ASIENTO_CTRL\", \"targetTable\": \"CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG\" }, { \"since\": \"2021-11-18T18:00:00.000Z\", \"sourceTable\": \"CDOCPRBD.OMNICANAL.BITACORA_ASIENTO_DET\", \"targetTable\": \"CDOCPRBD.OMNICANAL.BITACORA_ASIENTO_DET\", \"operations\": [ { \"operation\": \"insert\", \"count\": 353 }, { \"operation\": \"update\", \"count\": 0 },{ \"operation\": \"before\", \"count\": 0 },{ \"operation\": \"alterBefore\", \"count\": 0 }, { \"operation\": \"delete\", \"count\": 0 },{ \"operation\": \"upsert\", \"count\": 0 },{ \"operation\": \"unsupported\", \"count\": 0 }, { \"operation\": \"drop\", \"count\": 0 }, { \"operation\": \"truncate\", \"count\": 0 },{ \"operation\": \"discard\", \"count\": 0 },{ \"operation\": \"ignore\", \"count\": 0 },{ \"operation\": \"operations\", \"count\": 353 },{ \"operation\": \"insertCollision\", \"count\": 0 },{ \"operation\": \"updateCollision\", \"count\": 0 },{ \"operation\": \"deleteCollision\", \"count\": 0 } ] },{ \"since\": \"2021-11-18T18:00:00.000Z\", \"sourceTable\": \"CDOCPRBD.OMNICANAL.BITACORA_ASIENTO_DET\", \"targetTable\": \"CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG\" }, { \"since\": \"2021-11-18T18:00:00.000Z\", \"sourceTable\": \"CDOCPRBD.OMNICANAL.BITACORA_ASIENTO\", \"targetTable\": \"CDOCPRBD.OMNICANAL.BITACORA_ASIENTO\", \"operations\": [ { \"operation\": \"insert\", \"count\": 473 }, { \"operation\": \"update\", \"count\": 0 },{ \"operation\": \"before\", \"count\": 0 },{\"operation\": \"alterBefore\", \"count\": 0 }, { \"operation\": \"delete\", \"count\": 104 }, { \"operation\": \"upsert\", \"count\": 0 }, { \"operation\": \"unsupported\", \"count\": 0 }, { \"operation\": \"drop\", \"count\": 0 },{ \"operation\": \"truncate\", \"count\": 0 },{ \"operation\": \"discard\", \"count\": 0 },{ \"operation\": \"ignore\", \"count\": 0 }, { \"operation\": \"operations\", \"count\": 577 }, { \"operation\": \"insertCollision\", \"count\": 0 },{ \"operation\": \"updateCollision\", \"count\": 0 },{ \"operation\": \"deleteCollision\", \"count\": 0 } ] }, {\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.BITACORA_ASIENTO\",\"targetTable\":\"CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG\"},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.CLIENTE\",\"targetTable\":\"CDOCPRBD.OMNICANAL.CLIENTE\",\"operations\":[{\"operation\":\"insert\",\"count\":17},{\"operation\":\"update\",\"count\":10},{\"operation\":\"before\",\"count\":0},{\"operation\":\"alterBefore\",\"count\":0},{\"operation\":\"delete\",\"count\":0},{\"operation\":\"upsert\",\"count\":0},{\"operation\":\"unsupported\",\"count\":0},{\"operation\":\"drop\",\"count\":0},{\"operation\":\"truncate\",\"count\":0},{\"operation\":\"discard\",\"count\":0},{\"operation\":\"ignore\",\"count\":0},{\"operation\":\"operations\",\"count\":27},{\"operation\":\"insertCollision\",\"count\":0},{\"operation\":\"updateCollision\",\"count\":0},{\"operation\":\"deleteCollision\",\"count\":0}]},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.CLIENTE\",\"targetTable\":\"CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG\"},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.BITACORA_CONFVTA_CTRL\",\"targetTable\":\"CDOCPRBD.OMNICANAL.BITACORA_CONFVTA_CTRL\",\"operations\":[{\"operation\":\"insert\",\"count\":138},{\"operation\":\"update\",\"count\":100},{\"operation\":\"before\",\"count\":0},{\"operation\":\"alterBefore\",\"count\":0},{\"operation\":\"delete\",\"count\":0},{\"operation\":\"upsert\",\"count\":0},{\"operation\":\"unsupported\",\"count\":0},{\"operation\":\"drop\",\"count\":0},{\"operation\":\"truncate\",\"count\":0},{\"operation\":\"discard\",\"count\":0},{\"operation\":\"ignore\",\"count\":0},{\"operation\":\"operations\",\"count\":238},{\"operation\":\"insertCollision\",\"count\":0},{\"operation\":\"updateCollision\",\"count\":0},{\"operation\":\"deleteCollision\",\"count\":0}]},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.BITACORA_CONFVTA_CTRL\",\"targetTable\":\"CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG\"},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.BITACORA_CONFVTA_DET\",\"targetTable\":\"CDOCPRBD.OMNICANAL.BITACORA_CONFVTA_DET\",\"operations\":[{\"operation\":\"insert\",\"count\":155},{\"operation\":\"update\",\"count\":0},{\"operation\":\"before\",\"count\":0},{\"operation\":\"alterBefore\",\"count\":0},{\"operation\":\"delete\",\"count\":0},{\"operation\":\"upsert\",\"count\":0},{\"operation\":\"unsupported\",\"count\":0},{\"operation\":\"drop\",\"count\":0},{\"operation\":\"truncate\",\"count\":0},{\"operation\":\"discard\",\"count\":0},{\"operation\":\"ignore\",\"count\":0},{\"operation\":\"operations\",\"count\":155},{\"operation\":\"insertCollision\",\"count\":0},{\"operation\":\"updateCollision\",\"count\":0},{\"operation\":\"deleteCollision\",\"count\":0}]},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.BITACORA_CONFVTA_DET\",\"targetTable\":\"CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG\"},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.BITACORA_CONFVTA_ASIENTO\",\"targetTable\":\"CDOCPRBD.OMNICANAL.BITACORA_CONFVTA_ASIENTO\",\"operations\":[{\"operation\":\"insert\",\"count\":198},{\"operation\":\"update\",\"count\":0},{\"operation\":\"before\",\"count\":0},{\"operation\":\"alterBefore\",\"count\":0},{\"operation\":\"delete\",\"count\":0},{\"operation\":\"upsert\",\"count\":0},{\"operation\":\"unsupported\",\"count\":0},{\"operation\":\"drop\",\"count\":0},{\"operation\":\"truncate\",\"count\":0},{\"operation\":\"discard\",\"count\":0},{\"operation\":\"ignore\",\"count\":0},{\"operation\":\"operations\",\"count\":198},{\"operation\":\"insertCollision\",\"count\":0},{\"operation\":\"updateCollision\",\"count\":0},{\"operation\":\"deleteCollision\",\"count\":0}]},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.BITACORA_CONFVTA_ASIENTO\",\"targetTable\":\"CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG\"},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.CLIENTE_INVITADO\",\"targetTable\":\"CDOCPRBD.OMNICANAL.CLIENTE_INVITADO\",\"operations\":[{\"operation\":\"insert\",\"count\":35},{\"operation\":\"update\",\"count\":41},{\"operation\":\"before\",\"count\":0},{\"operation\":\"alterBefore\",\"count\":0},{\"operation\":\"delete\",\"count\":0},{\"operation\":\"upsert\",\"count\":0},{\"operation\":\"unsupported\",\"count\":0},{\"operation\":\"drop\",\"count\":0},{\"operation\":\"truncate\",\"count\":0},{\"operation\":\"discard\",\"count\":0},{\"operation\":\"ignore\",\"count\":0},{\"operation\":\"operations\",\"count\":76},{\"operation\":\"insertCollision\",\"count\":0},{\"operation\":\"updateCollision\",\"count\":0},{\"operation\":\"deleteCollision\",\"count\":0}]},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.CLIENTE_INVITADO\",\"targetTable\":\"CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG\"},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.CLIENTE_DISPOSITIVO\",\"targetTable\":\"CDOCPRBD.OMNICANAL.CLIENTE_DISPOSITIVO\",\"operations\":[{\"operation\":\"insert\",\"count\":25},{\"operation\":\"update\",\"count\":24},{\"operation\":\"before\",\"count\":0},{\"operation\":\"alterBefore\",\"count\":0},{\"operation\":\"delete\",\"count\":0},{\"operation\":\"upsert\",\"count\":0},{\"operation\":\"unsupported\",\"count\":0},{\"operation\":\"drop\",\"count\":0},{\"operation\":\"truncate\",\"count\":0},{\"operation\":\"discard\",\"count\":0},{\"operation\":\"ignore\",\"count\":0},{\"operation\":\"operations\",\"count\":49},{\"operation\":\"insertCollision\",\"count\":0},{\"operation\":\"updateCollision\",\"count\":0},{\"operation\":\"deleteCollision\",\"count\":0}]},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.CLIENTE_DISPOSITIVO\",\"targetTable\":\"CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG\"},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.DISPOSITIVO\",\"targetTable\":\"CDOCPRBD.OMNICANAL.DISPOSITIVO\",\"operations\":[{\"operation\":\"insert\",\"count\":7},{\"operation\":\"update\",\"count\":20},{\"operation\":\"before\",\"count\":0},{\"operation\":\"alterBefore\",\"count\":0},{\"operation\":\"delete\",\"count\":0},{\"operation\":\"upsert\",\"count\":0},{\"operation\":\"unsupported\",\"count\":0},{\"operation\":\"drop\",\"count\":0},{\"operation\":\"truncate\",\"count\":0},{\"operation\":\"discard\",\"count\":0},{\"operation\":\"ignore\",\"count\":0},{\"operation\":\"operations\",\"count\":27},{\"operation\":\"insertCollision\",\"count\":0},{\"operation\":\"updateCollision\",\"count\":0},{\"operation\":\"deleteCollision\",\"count\":0}]},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.DISPOSITIVO\",\"targetTable\":\"CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG\"},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.SUSCRIPTOR_NOTICIAS\",\"targetTable\":\"CDOCPRBD.OMNICANAL.SUSCRIPTOR_NOTICIAS\",\"operations\":[{\"operation\":\"insert\",\"count\":12},{\"operation\":\"update\",\"count\":0},{\"operation\":\"before\",\"count\":0},{\"operation\":\"alterBefore\",\"count\":0},{\"operation\":\"delete\",\"count\":0},{\"operation\":\"upsert\",\"count\":0},{\"operation\":\"unsupported\",\"count\":0},{\"operation\":\"drop\",\"count\":0},{\"operation\":\"truncate\",\"count\":0},{\"operation\":\"discard\",\"count\":0},{\"operation\":\"ignore\",\"count\":0},{\"operation\":\"operations\",\"count\":12},{\"operation\":\"insertCollision\",\"count\":0},{\"operation\":\"updateCollision\",\"count\":0},{\"operation\":\"deleteCollision\",\"count\":0}]},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.SUSCRIPTOR_NOTICIAS\",\"targetTable\":\"CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG\"},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.BITACORA_CONSULTA_PAGO\",\"targetTable\":\"CDOCPRBD.OMNICANAL.BITACORA_CONSULTA_PAGO\",\"operations\":[{\"operation\":\"insert\",\"count\":242},{\"operation\":\"update\",\"count\":242},{\"operation\":\"before\",\"count\":0},{\"operation\":\"alterBefore\",\"count\":0},{\"operation\":\"delete\",\"count\":0},{\"operation\":\"upsert\",\"count\":0},{\"operation\":\"unsupported\",\"count\":0},{\"operation\":\"drop\",\"count\":0},{\"operation\":\"truncate\",\"count\":0},{\"operation\":\"discard\",\"count\":0},{\"operation\":\"ignore\",\"count\":0},{\"operation\":\"operations\",\"count\":484},{\"operation\":\"insertCollision\",\"count\":0},{\"operation\":\"updateCollision\",\"count\":0},{\"operation\":\"deleteCollision\",\"count\":0}]},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.BITACORA_CONSULTA_PAGO\",\"targetTable\":\"CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG\"},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.VIAJE_FAVORITO\",\"targetTable\":\"CDOCPRBD.OMNICANAL.VIAJE_FAVORITO\",\"operations\":[{\"operation\":\"insert\",\"count\":2},{\"operation\":\"update\",\"count\":0},{\"operation\":\"before\",\"count\":0},{\"operation\":\"alterBefore\",\"count\":0},{\"operation\":\"delete\",\"count\":0},{\"operation\":\"upsert\",\"count\":0},{\"operation\":\"unsupported\",\"count\":0},{\"operation\":\"drop\",\"count\":0},{\"operation\":\"truncate\",\"count\":0},{\"operation\":\"discard\",\"count\":0},{\"operation\":\"ignore\",\"count\":0},{\"operation\":\"operations\",\"count\":2},{\"operation\":\"insertCollision\",\"count\":0},{\"operation\":\"updateCollision\",\"count\":0},{\"operation\":\"deleteCollision\",\"count\":0}]},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.VIAJE_FAVORITO\",\"targetTable\":\"CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG\"},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.BITACORA_CUPON\",\"targetTable\":\"CDOCPRBD.OMNICANAL.BITACORA_CUPON\",\"operations\":[{\"operation\":\"insert\",\"count\":6},{\"operation\":\"update\",\"count\":0},{\"operation\":\"before\",\"count\":0},{\"operation\":\"alterBefore\",\"count\":0},{\"operation\":\"delete\",\"count\":0},{\"operation\":\"upsert\",\"count\":0},{\"operation\":\"unsupported\",\"count\":0},{\"operation\":\"drop\",\"count\":0},{\"operation\":\"truncate\",\"count\":0},{\"operation\":\"discard\",\"count\":0},{\"operation\":\"ignore\",\"count\":0},{\"operation\":\"operations\",\"count\":6},{\"operation\":\"insertCollision\",\"count\":0},{\"operation\":\"updateCollision\",\"count\":0},{\"operation\":\"deleteCollision\",\"count\":0}]},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.BITACORA_CUPON\",\"targetTable\":\"CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG\"},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.CLIENTE_PASAJERO\",\"targetTable\":\"CDOCPRBD.OMNICANAL.CLIENTE_PASAJERO\",\"operations\":[{\"operation\":\"insert\",\"count\":2},{\"operation\":\"update\",\"count\":0},{\"operation\":\"before\",\"count\":0},{\"operation\":\"alterBefore\",\"count\":0},{\"operation\":\"delete\",\"count\":0},{\"operation\":\"upsert\",\"count\":0},{\"operation\":\"unsupported\",\"count\":0},{\"operation\":\"drop\",\"count\":0},{\"operation\":\"truncate\",\"count\":0},{\"operation\":\"discard\",\"count\":0},{\"operation\":\"ignore\",\"count\":0},{\"operation\":\"operations\",\"count\":2},{\"operation\":\"insertCollision\",\"count\":0},{\"operation\":\"updateCollision\",\"count\":0},{\"operation\":\"deleteCollision\",\"count\":0}]},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.CLIENTE_PASAJERO\",\"targetTable\":\"CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG\"},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.SUSCRIPNOTICIAS_CONCEPTO\",\"targetTable\":\"CDOCPRBD.OMNICANAL.SUSCRIPNOTICIAS_CONCEPTO\"},{\"since\":\"2021-11-18T18:00:00.000Z\",\"sourceTable\":\"CDOCPRBD.OMNICANAL.SUSCRIPNOTICIAS_CONCEPTO\", \"targetTable\": \"CDOCPRBD.C##GGADMIN.EXCEPTION_ROTRANLOG\"}]}}}";


    @CrossOrigin
    @GetMapping("/repStats")
    public String getRepStats() throws Exception {
        /**
        StatsEntityConfig statsEntityConfig = new StatsEntityConfig();

        String url = CredentialsConfig.getCredentials().get(0).getUrl();
        System.out.println("url del  task"+url);
        StringBuilder sb = new StringBuilder ();

        sb.append(url).append("/services/v2/replicats/").append(StatsEntityConfig.getStatsParamsList().get(0).getParam()).append("/command");
        String urlfinal = sb.toString();
        System.out.println(urlfinal);
        String result=   httpMethods.getStatsData(urlfinal,CredentialsConfig.credentials.get(0).getUser(),CredentialsConfig.credentials.get(0).getPassword());
**/
        /**
         * Solo cambia la variable respuesta por la variable result del  metodo invocado
         *
         * **/
        StringBuilder stringBuilder = new StringBuilder (resp);
        StringBuilder json = new StringBuilder ();

        stringBuilder.delete(1,420);
        StringTokenizer st = new StringTokenizer(stringBuilder.toString());
        String palabra = null;
        String token= null;
         int conta =1;

         json.append("[ ");
        while (st.hasMoreTokens()) {
            palabra= st.nextToken();


            if (palabra.equals("\"since\":") && conta%2!=0){
           //     System.out.println("hola entre en el metodo");
                conta++;
                st.nextToken();
                continue;
            }


            if (palabra.equals("\"since\":" ) && conta%2==0) {
                conta++;
              //  System.out.println("SOY LA PALABRA!!!!!!"+palabra);
                // { since
                json.append("{ "+palabra);
                // since  fecha
                token=st.nextToken();

                // since fecha  source tavle
                json.append(" "+token);
                token=st.nextToken();

                // since fecha  source_tavle  valor
                json.append(" "+token);
                // since fecha  source_tavle  valor tabla destino
                token=st.nextToken();

                json.append(" "+token);
                // since fecha  source_tavle  valor tabla destino  valor
                token=st.nextToken();

                json.append(" "+token);
                token=st.nextToken();

                json.append(" "+token);

                while (!token.equals("]")){
                 token=   st.nextToken();


                 if (token.equals("\"operation\":")){
                     palabra= st.nextToken();

                     StringBuilder oper = new StringBuilder(palabra);
                     int tam = oper.length();
                     oper.deleteCharAt(tam-1);
                     json.append(oper.toString()+": ");
                     token = st.nextToken();

                     token = st.nextToken();

                     json.append(token);
                     json.append(", ");
                 }


                }
                    json.append("},");

            }

        }
            json.append(" ]");
            return json.toString();
      //  return stringBuilder.toString();
    }


    public String getRepStatus(String urlfinal) throws Exception {



        String result=   httpMethods.peticionHttpGet(urlfinal,CredentialsConfig.credentials.get(0).getUser(),CredentialsConfig.credentials.get(0).getPassword());

        return result;
    }

}
